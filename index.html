<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, viewport-fit=cover" />
    <title>ì‹íƒë³´ AI</title>
    <base href="/" />

    <!-- PWA ë©”íƒ€ íƒœê·¸ -->
    <meta name="description" content="AI ì±—ë´‡ê³¼ Windows Sandbox ì„¤ì •ì„ í•œ ê³³ì—ì„œ ê´€ë¦¬í•˜ëŠ” PWA ì•±" />
    <meta name="keywords" content="ì‹íƒë³´, AI, ì±—ë´‡, Windows Sandbox, PWA, ì˜¤í”ˆë¼ìš°í„°" />
    <meta name="author" content="ì‹íƒë³´ íŒ€" />
    <meta name="theme-color" content="#03173d" />
    <meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff" />
    <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#03173d" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="apple-mobile-web-app-title" content="ì‹íƒë³´ AI" />
    <meta name="application-name" content="ì‹íƒë³´ AI" />
    <meta name="msapplication-TileColor" content="#03173d" />
    <meta name="msapplication-tap-highlight" content="no" />
    <meta name="format-detection" content="telephone=no" />

    <!-- iOS ìŠ¤í”Œë˜ì‹œ ìŠ¤í¬ë¦° (ì„ íƒì ) -->
    <link rel="apple-touch-startup-image" href="icon-512.png" />

    <!-- Open Graph ë©”íƒ€ íƒœê·¸ -->
    <meta property="og:type" content="website" />
    <meta property="og:title" content="ì‹íƒë³´ AI" />
    <meta property="og:description" content="AI ì±—ë´‡ê³¼ Windows Sandbox ì„¤ì •ì„ í•œ ê³³ì—ì„œ ê´€ë¦¬í•˜ëŠ” PWA ì•±" />
    <meta property="og:url" content="https://yourtablecloth.app/" />
    <meta property="og:image" content="https://yourtablecloth.app/icon-512.png" />
    <meta property="og:site_name" content="ì‹íƒë³´ AI" />

    <!-- Twitter Card ë©”íƒ€ íƒœê·¸ -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="ì‹íƒë³´ AI" />
    <meta name="twitter:description" content="AI ì±—ë´‡ê³¼ Windows Sandbox ì„¤ì •ì„ í•œ ê³³ì—ì„œ ê´€ë¦¬í•˜ëŠ” PWA ì•±" />
    <meta name="twitter:image" content="https://yourtablecloth.app/icon-512.png" />

    <!-- í…Œë§ˆ ì´ˆê¸° ë¡œë”© ìŠ¤í¬ë¦½íŠ¸ (FOUC ë°©ì§€) -->
    <script>
        (function () {
            const savedTheme = localStorage.getItem('theme-preference') || 'Auto';
            const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
            const prefersLight = window.matchMedia && window.matchMedia('(prefers-color-scheme: light)').matches;

            // ì‹œìŠ¤í…œ í…Œë§ˆ ìƒì„¸ ì •ë³´
            const systemThemeInfo = {
                mediaQuerySupported: !!window.matchMedia,
                prefersDark: prefersDark,
                prefersLight: prefersLight,
                noPreference: !prefersDark && !prefersLight,
                userAgent: navigator.userAgent,
                platform: getPlatform(),
                currentTime: new Date().toLocaleString()
            };

            let shouldApplyDark = false;
            let reason = '';

            if (savedTheme === 'Dark') {
                shouldApplyDark = true;
                reason = 'ì‚¬ìš©ìê°€ ë‹¤í¬ ëª¨ë“œë¥¼ ì„ íƒí•¨';
            } else if (savedTheme === 'Light') {
                shouldApplyDark = false;
                reason = 'ì‚¬ìš©ìê°€ ë¼ì´íŠ¸ ëª¨ë“œë¥¼ ì„ íƒí•¨';
            } else if (savedTheme === 'Auto') {
                shouldApplyDark = prefersDark;
                reason = prefersDark ?
                    'ìë™ ëª¨ë“œ: ì‹œìŠ¤í…œì—ì„œ ë‹¤í¬ ëª¨ë“œë¥¼ ì„ í˜¸í•¨' :
                    'ìë™ ëª¨ë“œ: ì‹œìŠ¤í…œì—ì„œ ë¼ì´íŠ¸ ëª¨ë“œë¥¼ ì„ í˜¸í•¨ (ë˜ëŠ” ì„ í˜¸ë„ ì—†ìŒ)';
            }

            console.log('ğŸ¨ í…Œë§ˆ ì´ˆê¸° ë¡œë”© ìƒì„¸ ì •ë³´:', {
                savedTheme,
                shouldApplyDark,
                reason,
                systemInfo: systemThemeInfo
            });

            // í”Œë«í¼ ê°ì§€ í•¨ìˆ˜
            function getPlatform() {
                const ua = navigator.userAgent;
                if (ua.includes('Windows')) return 'Windows';
                if (ua.includes('Mac')) return 'macOS';
                if (ua.includes('iPhone') || ua.includes('iPad')) return 'iOS';
                if (ua.includes('Android')) return 'Android';
                if (ua.includes('Linux')) return 'Linux';
                return 'Unknown';
            }

            if (shouldApplyDark) {
                document.documentElement.classList.add('dark-theme');
                document.documentElement.classList.remove('light-theme');
                console.log('âœ… ë‹¤í¬ í…Œë§ˆ í´ë˜ìŠ¤ ì ìš©');
            } else {
                document.documentElement.classList.add('light-theme');
                document.documentElement.classList.remove('dark-theme');
                console.log('âœ… ë¼ì´íŠ¸ í…Œë§ˆ í´ë˜ìŠ¤ ì ìš©');
            }

            // ì ìš©ëœ í´ë˜ìŠ¤ì™€ CSS ë³€ìˆ˜ í™•ì¸
            setTimeout(() => {
                console.log('ğŸ“‹ HTML í´ë˜ìŠ¤ ëª©ë¡:', document.documentElement.className);
                const computedStyle = getComputedStyle(document.documentElement);
                console.log('ğŸ¨ ì ìš©ëœ CSS ë³€ìˆ˜ë“¤:', {
                    '--primary-bg': computedStyle.getPropertyValue('--primary-bg').trim(),
                    '--primary-text': computedStyle.getPropertyValue('--primary-text').trim(),
                    '--accent-color': computedStyle.getPropertyValue('--accent-color').trim()
                });

                // ì‹œìŠ¤í…œ í…Œë§ˆ ë³€ê²½ ê°ì§€ ì„¤ì •
                if (window.matchMedia) {
                    const darkModeMediaQuery = window.matchMedia('(prefers-color-scheme: dark)');
                    darkModeMediaQuery.addEventListener('change', (e) => {
                        console.log('ğŸ”„ ì‹œìŠ¤í…œ í…Œë§ˆ ë³€ê²½ ê°ì§€:', e.matches ? 'ë‹¤í¬ ëª¨ë“œ' : 'ë¼ì´íŠ¸ ëª¨ë“œ');
                        if (localStorage.getItem('theme-preference') === 'Auto') {
                            console.log('âš¡ ìë™ ëª¨ë“œì´ë¯€ë¡œ í…Œë§ˆ ìë™ ë³€ê²½');
                        }
                    });
                }
            }, 100);
        })();
    </script>

    <link rel="preload" id="webassembly" />
    <link rel="stylesheet" href="lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="css/app.css" />
    <link rel="icon" type="image/png" href="favicon.png" />

    <!-- PWA ë§¤ë‹ˆí˜ìŠ¤íŠ¸ -->
    <link href="manifest.webmanifest" rel="manifest" />

    <!-- Apple í„°ì¹˜ ì•„ì´ì½˜ -->
    <link rel="apple-touch-icon" sizes="512x512" href="icon-512.png" />
    <link rel="apple-touch-icon" sizes="192x192" href="icon-192.png" />

    <!-- Favicon ë‹¤ì–‘í•œ í¬ê¸° -->
    <link rel="icon" type="image/png" sizes="192x192" href="icon-192.png" />
    <link rel="icon" type="image/png" sizes="512x512" href="icon-512.png" />

    <!-- TODO: MSBuildë¡œ ì´ì „ ê²€í†  -->
    <link href="https://yourtablecloth.app/TableClothCatalog/Catalog.xml" rel="prefetch" />
    <link href="TableClothLite.styles.css" rel="stylesheet" />

    <script type="importmap"></script>
</head>

<body>
    <div id="app">
        <svg class="loading-progress">
            <circle r="40%" cx="50%" cy="50%" />
            <circle r="40%" cx="50%" cy="50%" />
        </svg>
        <div class="loading-progress-text"></div>
    </div>

    <!-- Start Single Page Apps for GitHub Pages -->
    <script type="text/javascript">
        // Single Page Apps for GitHub Pages
        // https://github.com/rafrex/spa-github-pages
        // Copyright (c) 2016 Rafael Pedicini, licensed under the MIT License
        // ----------------------------------------------------------------------
        // This script checks to see if a redirect is present in the query string
        // and converts it back into the correct url and adds it to the
        // browser's history using window.history.replaceState(...),
        // which won't cause the browser to attempt to load the new url.
        // When the single page app is loaded further down in this file,
        // the correct url will be waiting in the browser's history for
        // the single page app to route accordingly.
        (function (l) {
            if (l.search) {
                var q = {};
                l.search.slice(1).split('&').forEach(function (v) {
                    var a = v.split('=');
                    q[a[0]] = a.slice(1).join('=').replace(/~and~/g, '&');
                });
                if (q.p !== undefined) {
                    window.history.replaceState(null, null,
                        l.pathname.slice(0, -1) + (q.p || '') +
                        (q.q ? ('?' + q.q) : '') +
                        l.hash
                    );
                }
            }
        }(window.location))
    </script>

    <div id="blazor-error-ui">
        ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.
        <a href="." class="reload">ìƒˆë¡œ ê³ ì¹¨</a>
        <span class="dismiss">&#x1F5D9;</span>
    </div>

    <!-- app.jsë¥¼ ë¨¼ì € ë¡œë“œ -->
    <script type='module' src="js/app#[.{fingerprint}].js"></script>
    <script src="_framework/blazor.webassembly#[.{fingerprint}].js"></script>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-HBJP4P0EBY"></script>
    <script type="text/javascript">
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'G-HBJP4P0EBY');
    </script>
</body>

</html>